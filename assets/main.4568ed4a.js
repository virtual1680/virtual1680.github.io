var x=Object.defineProperty;var y=(a,e,t)=>e in a?x(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var l=(a,e,t)=>(y(a,typeof e!="symbol"?e+"":e,t),t);import{_ as w}from"./index.308dce99.js";import{H as m,r as b,e as h,k as R,l as k,m as d,K as o,u as r}from"./vue.e587a6e4.js";import"./element-plus.99fc94f8.js";class D{constructor(e){l(this,"video");l(this,"mediaRecorder");l(this,"chunks");this.video=e,this.mediaRecorder=null,this.chunks=[]}init(){return new Promise((e,t)=>{navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(i=>{"srcObject"in this.video&&(this.video.srcObject=i),this.video.addEventListener("loadmetadata",()=>{this.video.play()}),this.mediaRecorder=new MediaRecorder(i),this.mediaRecorder.addEventListener("dataavailable",p=>{this.chunks.push(p.data)}),e()}).catch(i=>{t(i)})})}startRecord(){this.mediaRecorder.state==="inactive"&&this.mediaRecorder.start()}stopRecord(){this.mediaRecorder.state==="recording"&&this.mediaRecorder.stop()}async isSupport(){if(await(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)())return!0}}const E={class:"basic-video__border"},L=["src"],N=m({name:"basic-video"}),S=m({...N,props:{background:{type:String},width:{type:Number,default:500}},emits:["data-change"],setup(a,{emit:e}){const t=a,i=b(),p=h(()=>({width:`${t.width}px`})),u=h(()=>({width:`${t.width/2}px`})),s=h(()=>({width:`${t.width/15}px`,height:`${t.width/15}px`,borderWidth:`${5}px`})),n=b(),_=()=>{n.value=new D(i.value),n.value.init().then(()=>{n.value.mediaRecorder.addEventListener("stop",f,!1)})},f=()=>{const v=new Blob(n.value.chunks,{type:"video/mp4"}),c=new FileReader;c.readAsDataURL(v),c.addEventListener("loadend",()=>{let g=c.result;e("data-change",g)})};return _(),(v,c)=>(R(),k("div",{style:o(r(p)),class:"basic-video"},[d("div",E,[d("span",{style:o(r(s))},null,4),d("span",{style:o(r(s))},null,4),d("span",{style:o(r(s))},null,4),d("span",{style:o(r(s))},null,4)]),d("img",{style:o(r(u)),class:"basic-video__img",src:a.background},null,12,L),d("video",{class:"basic-video__main",ref_key:"main",ref:i,autoplay:"",muted:""},null,512)],4))}});var O=w(S,[["__scopeId","data-v-d0436e8c"]]);export{O as default};
//# sourceMappingURL=main.4568ed4a.js.map
