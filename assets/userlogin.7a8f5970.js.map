{"version":3,"file":"userlogin.7a8f5970.js","sources":["../../src/page/login/userlogin.vue"],"sourcesContent":["<template>\n\t<el-form class=\"login-form\" status-icon :rules=\"loginRules\" ref=\"ruleFormRef\" :model=\"loginForm\" label-width=\"0\">\n\t\t<el-form-item prop=\"username\">\n\t\t\t<el-input @keyup.enter=\"handleLogin\" v-model=\"loginForm.username\" auto-complete=\"off\" :placeholder=\"$t('login.username')\">\n\t\t\t\t<template #prefix>\n\t\t\t\t\t<i class=\"icon-yonghu\"></i>\n\t\t\t\t</template>\n\t\t\t</el-input>\n\t\t</el-form-item>\n\t\t<el-form-item prop=\"password\">\n\t\t\t<el-input @keyup.enter=\"handleLogin\" :type=\"passwordType\" v-model=\"loginForm.password\" auto-complete=\"off\" :placeholder=\"$t('login.password')\">\n\t\t\t\t<template #suffix>\n\t\t\t\t\t<i class=\"el-icon-view el-input__icon\" @click=\"showPassword\"></i>\n\t\t\t\t</template>\n\t\t\t\t<template #prefix>\n\t\t\t\t\t<i class=\"icon-mima\"></i>\n\t\t\t\t</template>\n\t\t\t</el-input>\n\t\t</el-form-item>\n\t\t<el-form-item prop=\"code\">\n\t\t\t<el-input @keyup.enter=\"handleLogin\" :maxlength=\"code.len\" v-model=\"loginForm.code\" auto-complete=\"off\" :placeholder=\"$t('login.code')\">\n\t\t\t\t<template #prefix>\n\t\t\t\t\t<i class=\"icon-yanzhengma\"></i>\n\t\t\t\t</template>\n\t\t\t\t<template #append>\n\t\t\t\t\t<div class=\"login-code\">\n\t\t\t\t\t\t<span class=\"login-code-img\" @click=\"refreshCode\" v-if=\"code.type == 'text'\">{{ code.value }}</span>\n\t\t\t\t\t\t<img :src=\"code.src\" class=\"login-code-img\" @click=\"refreshCode\" v-else />\n\t\t\t\t\t\t<!-- <i class=\"icon-shuaxin login-code-icon\" @click=\"refreshCode\"></i> -->\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</el-input>\n\t\t</el-form-item>\n\n\t\t<el-form-item>\n\t\t\t<el-button type=\"primary\" @click.prevent=\"handleLogin(ruleFormRef)\" class=\"login-submit\">{{ $t('login.submit') }}</el-button>\n\t\t</el-form-item>\n\t</el-form>\n</template>\n\n<script lang=\"ts\" setup name=\"UserLogin\">\nimport { reactive, ref } from 'vue';\nimport { randomLenNum } from 'utils/util';\nimport { FormInstance } from 'element-plus';\nimport { useUserStore, useTagsStore } from 'store/index';\nimport { useRouter } from 'vue-router';\nconst router = useRouter();\nconst uStore = useUserStore();\nconst tStore = useTagsStore();\nlet loginForm = reactive({\n\tusername: 'admin',\n\tpassword: '123456',\n\tcode: '',\n\tredomStr: ''\n});\nlet code = reactive({\n\tsrc: '',\n\tvalue: '',\n\tlen: 4,\n\ttype: 'text'\n});\nconst passwordType = ref('password');\n// const checked = ref(false);\nconst ruleFormRef = ref<FormInstance>();\n\nconst refreshCode = () => {\n\tloginForm.redomStr = randomLenNum(code.len, true);\n\tcode.type == 'text' ? (code.value = randomLenNum(code.len, false)) : (code.src = `/${loginForm.redomStr}`);\n\tloginForm.code = code.value;\n};\n\nconst validateCode = (_: unknown, value: string, callback: (error?: Error) => void) => {\n\tif (code.value != value) {\n\t\tloginForm.code = '';\n\t\trefreshCode();\n\t\tcallback(new Error('请输入正确的验证码'));\n\t} else {\n\t\tcallback();\n\t}\n};\nconst loginRules = {\n\tusername: [{ required: true, message: '请输入用户名', trigger: 'blur' }],\n\tpassword: [\n\t\t{ required: true, message: '请输入密码', trigger: 'blur' },\n\t\t{ min: 6, message: '密码长度最少为6位', trigger: 'blur' }\n\t],\n\tcode: [\n\t\t{ required: true, message: '请输入验证码', trigger: 'blur' },\n\t\t{ min: 4, max: 4, message: '验证码长度为4位', trigger: 'blur' },\n\t\t{ required: true, trigger: 'blur', validator: validateCode }\n\t]\n};\nrefreshCode();\nconst showPassword = () => {\n\tpasswordType.value == '' ? (passwordType.value = 'password') : (passwordType.value = '');\n};\nconst handleLogin = async (formEl: FormInstance | undefined) => {\n\tif (!formEl) return;\n\tawait formEl.validate((valid, fields) => {\n\t\tif (valid) {\n\t\t\tuStore.LoginByUsername(loginForm).then(() => {\n\t\t\t\trouter.push(tStore.getTagWel);\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.log('error submit!', fields);\n\t\t}\n\t});\n};\n\n// ...mapState(['tagWel'])\n</script>\n\n<style></style>\n"],"names":[],"mappings":"qbA8CA,KAAA,GAAA,IACA,EAAA,IACA,EAAA,IACA,GAAA,GAAA,EAAA,CACA,SAAA,QACA,SAAA,SACA,KAAA,GACA,SAAA,EAAA,CACA,EACA,EAAA,EAAA,CACA,IAAA,GACA,MAAA,GACA,IAAA,EACA,KAAA,MAAA,CACA,EACA,KAAA,GAAA,EAAA,UAAA,EAEA,EAAA,IAEA,EAAA,IAAA,CACA,EAAA,SAAA,EAAA,EAAA,IAAA,EAAA,EACA,EAAA,MAAA,OAAA,EAAA,MAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,IAAA,IAAA,EAAA,WACA,EAAA,KAAA,EAAA,KAAA,EAYA,EAAA,CACA,SAAA,CAAA,CAAA,SAAA,GAAA,QAAA,uCAAA,QAAA,OAAA,EACA,SAAA,CACA,CAAA,SAAA,GAAA,QAAA,iCAAA,QAAA,MAAA,EACA,CAAA,IAAA,EAAA,QAAA,oDAAA,QAAA,MAAA,CACA,EACA,KAAA,CACA,CAAA,SAAA,GAAA,QAAA,uCAAA,QAAA,MAAA,EACA,CAAA,IAAA,EAAA,IAAA,EAAA,QAAA,8CAAA,QAAA,MAAA,EACA,CAAA,SAAA,GAAA,QAAA,OAAA,UAlBA,CAAA,EAAA,EAAA,IAAA,CACA,AAAA,EAAA,OAAA,EACA,GAAA,KAAA,GACA,IACA,EAAA,GAAA,OAAA,wDAAA,CAAA,GAEA,GACA,CAWA,CACA,CAAA,EAEA,IACA,KAAA,GAAA,IAAA,CACA,EAAA,OAAA,GAAA,EAAA,MAAA,WAAA,EAAA,MAAA,EAAA,EAEA,EAAA,KAAA,IAAA,CACA,AAAA,CAAA,GACA,KAAA,GAAA,SAAA,CAAA,EAAA,IAAA,CACA,AAAA,GACA,EAAA,gBAAA,CAAA,EAAA,KAAA,IAAA,CACA,EAAA,KAAA,EAAA,SAAA,CAAA,CACA,CAGA,CACA,CAAA"}