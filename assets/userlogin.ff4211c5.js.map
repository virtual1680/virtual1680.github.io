{"version":3,"file":"userlogin.ff4211c5.js","sources":["../../src/page/login/userlogin.vue"],"sourcesContent":["<template>\n\t<el-form class=\"login-form\" status-icon :rules=\"loginRules\" ref=\"ruleFormRef\" :model=\"loginForm\" label-width=\"0\">\n\t\t<el-form-item prop=\"username\">\n\t\t\t<el-input @keyup.enter=\"handleLogin\" v-model=\"loginForm.username\" auto-complete=\"off\" :placeholder=\"$t('login.username')\">\n\t\t\t\t<template #prefix>\n\t\t\t\t\t<i class=\"icon-yonghu\"></i>\n\t\t\t\t</template>\n\t\t\t</el-input>\n\t\t</el-form-item>\n\t\t<el-form-item prop=\"password\">\n\t\t\t<el-input @keyup.enter=\"handleLogin\" :type=\"passwordType\" v-model=\"loginForm.password\" auto-complete=\"off\" :placeholder=\"$t('login.password')\">\n\t\t\t\t<template #suffix>\n\t\t\t\t\t<i class=\"el-icon-view el-input__icon\" @click=\"showPassword\"></i>\n\t\t\t\t</template>\n\t\t\t\t<template #prefix>\n\t\t\t\t\t<i class=\"icon-mima\"></i>\n\t\t\t\t</template>\n\t\t\t</el-input>\n\t\t</el-form-item>\n\t\t<el-form-item prop=\"code\">\n\t\t\t<el-input @keyup.enter=\"handleLogin\" :maxlength=\"code.len\" v-model=\"loginForm.code\" auto-complete=\"off\" :placeholder=\"$t('login.code')\">\n\t\t\t\t<template #prefix>\n\t\t\t\t\t<i class=\"icon-yanzhengma\"></i>\n\t\t\t\t</template>\n\t\t\t\t<template #append>\n\t\t\t\t\t<div class=\"login-code\">\n\t\t\t\t\t\t<span class=\"login-code-img\" @click=\"refreshCode\" v-if=\"code.type == 'text'\">{{ code.value }}</span>\n\t\t\t\t\t\t<img :src=\"code.src\" class=\"login-code-img\" @click=\"refreshCode\" v-else />\n\t\t\t\t\t\t<!-- <i class=\"icon-shuaxin login-code-icon\" @click=\"refreshCode\"></i> -->\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</el-input>\n\t\t</el-form-item>\n\n\t\t<el-form-item>\n\t\t\t<el-button type=\"primary\" @click.prevent=\"handleLogin(ruleFormRef)\" class=\"login-submit\">{{ $t('login.submit') }}</el-button>\n\t\t</el-form-item>\n\t</el-form>\n</template>\n\n<script lang=\"ts\" setup name=\"UserLogin\">\nimport { reactive, ref } from 'vue';\nimport { randomLenNum } from 'utils/util';\nimport { FormInstance } from 'element-plus';\nimport { useUserStore, useTagsStore } from 'store/index';\nimport { useRouter } from 'vue-router';\nconst router = useRouter();\nconst uStore = useUserStore();\nconst tStore = useTagsStore();\nlet loginForm = reactive({\n\tusername: 'admin',\n\tpassword: '123456',\n\tcode: '',\n\tredomStr: ''\n});\nlet code = reactive({\n\tsrc: '',\n\tvalue: '',\n\tlen: 4,\n\ttype: 'text'\n});\nconst passwordType = ref('password');\n// const checked = ref(false);\nconst ruleFormRef = ref<FormInstance>();\n\nconst refreshCode = () => {\n\tloginForm.redomStr = randomLenNum(code.len, true);\n\tcode.type == 'text' ? (code.value = randomLenNum(code.len, false)) : (code.src = `/${loginForm.redomStr}`);\n\tloginForm.code = code.value;\n};\n\nconst validateCode = (_: unknown, value: string, callback: (error?: Error) => void) => {\n\tif (code.value != value) {\n\t\tloginForm.code = '';\n\t\trefreshCode();\n\t\tcallback(new Error('请输入正确的验证码'));\n\t} else {\n\t\tcallback();\n\t}\n};\nconst loginRules = {\n\tusername: [{ required: true, message: '请输入用户名', trigger: 'blur' }],\n\tpassword: [\n\t\t{ required: true, message: '请输入密码', trigger: 'blur' },\n\t\t{ min: 6, message: '密码长度最少为6位', trigger: 'blur' }\n\t],\n\tcode: [\n\t\t{ required: true, message: '请输入验证码', trigger: 'blur' },\n\t\t{ min: 4, max: 4, message: '验证码长度为4位', trigger: 'blur' },\n\t\t{ required: true, trigger: 'blur', validator: validateCode }\n\t]\n};\nrefreshCode();\nconst showPassword = () => {\n\tpasswordType.value == '' ? (passwordType.value = 'password') : (passwordType.value = '');\n};\nconst handleLogin = async (formEl: FormInstance | undefined) => {\n\tif (!formEl) return;\n\tawait formEl.validate((valid, fields) => {\n\t\tif (valid) {\n\t\t\tuStore.LoginByUsername(loginForm).then(() => {\n\t\t\t\trouter.push(tStore.getTagWel);\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.log('error submit!', fields);\n\t\t}\n\t});\n};\n\n// ...mapState(['tagWel'])\n</script>\n\n<style></style>\n"],"names":["router","VueRouter","useRouter","uStore","useUserStore","tStore","useTagsStore","loginForm","Vue","reactive","username","password","code","redomStr","src","value","len","type","passwordType","ruleFormRef","ref","refreshCode","randomLenNum","loginRules","required","message","trigger","min","max","validator","_","callback","Error","showPassword","handleLogin","async","formEl","validate","valid","fields","LoginByUsername","then","push","getTagWel"],"mappings":"kWA8CA,MAAAA,EAAAC,UAAAC,YACAC,EAAAC,IACAC,EAAAC,IACA,IAAAC,EAAAC,IAAAC,SAAA,CAAAC,SAAA,QACAC,SAAA,SACAC,KAAA,GACAC,SAAA,KAGAD,EAAAJ,IAAAC,SAAA,CAAAK,IAAA,GACAC,MAAA,GACAC,IAAA,EACAC,KAAA,SAGA,MAAAC,EAAAV,oBAEAW,EAAAX,IAAAY,MAEAC,EAAA,KACAd,EAAAM,SAAAS,EAAAV,EAAAI,KAAA,GACA,QAAAJ,EAAAK,KAAAL,EAAAG,MAAAO,EAAAV,EAAAI,KAAA,GAAAJ,EAAAE,IAAA,IAAAP,EAAAM,WACAN,EAAAK,KAAAA,EAAAG,OAYAQ,EAAA,CAAAb,SAAA,CAAA,CAAAc,UAAA,EAAAC,QAAA,SAAAC,QAAA,SACAf,SAAA,CACA,CAAAa,UAAA,EAAAC,QAAA,QAAAC,QAAA,QACA,CAAAC,IAAA,EAAAF,QAAA,YAAAC,QAAA,SAEAd,KAAA,CACA,CAAAY,UAAA,EAAAC,QAAA,SAAAC,QAAA,QACA,CAAAC,IAAA,EAAAC,IAAA,EAAAH,QAAA,WAAAC,QAAA,QACA,CAAAF,UAAA,EAAAE,QAAA,OAAAG,UAjBA,CAAAC,EAAAf,EAAAgB,KACAnB,EAAAG,OAAAA,GACAR,EAAAK,KAAA,OAEAmB,EAAA,IAAAC,MAAA,2BAkBA,MAAAC,EAAA,KACA,IAAAf,EAAAH,MAAAG,EAAAH,MAAA,WAAAG,EAAAH,MAAA,IAEAmB,EAAAC,MAAAC,IACAA,SACAA,EAAAC,UAAA,CAAAC,EAAAC,KACAD,GACAnC,EAAAqC,gBAAAjC,GAAAkC,MAAA,KACAzC,EAAA0C,KAAArC,EAAAsC"}