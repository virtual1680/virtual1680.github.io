{"version":3,"file":"main.5ae26683.js","sources":["../../src/components/iframe/main.vue"],"sourcesContent":["<template>\r\n\t<basic-container>\r\n\t\t<iframe :src=\"src\" class=\"iframe\" ref=\"iframeRef\"></iframe>\r\n\t</basic-container>\r\n</template>\r\n\r\n<script lang=\"ts\" setup name=\"AvueIframe\">\r\nimport NProgress from 'nprogress'; // progress bar\r\nimport 'nprogress/nprogress.css'; // progress bar style\r\nimport { computed, ref, Ref, watch } from 'vue';\r\nimport { useRoute } from 'vue-router';\r\nconst route = useRoute();\r\nconst iframeRef: Ref<HTMLIFrameElement | undefined> = ref();\r\nNProgress.configure({ showSpinner: false });\r\nconst src = computed(() => {\r\n\treturn (route.query.url as string).replace(/#/g, '&');\r\n});\r\n\r\nwatch(\r\n\t() => route.query,\r\n\t() => {\r\n\t\tload();\r\n\t}\r\n);\r\n\r\n// 显示等待框\r\nconst show = () => {\r\n\tNProgress.start();\r\n};\r\n// 隐藏等待狂\r\nconst hide = () => {\r\n\tNProgress.done();\r\n};\r\n// 加载组件\r\nconst load = () => {\r\n\tshow();\r\n\t//超时3s自动隐藏等待狂，加强用户体验\r\n\tlet time = 3;\r\n\tconst timeFunc = setInterval(() => {\r\n\t\ttime--;\r\n\t\tif (time == 0) {\r\n\t\t\thide();\r\n\t\t\tclearInterval(timeFunc);\r\n\t\t}\r\n\t}, 1000);\r\n\tiframeInit();\r\n};\r\n//iframe窗口初始化\r\nconst iframeInit = () => {\r\n\tconst clientHeight = document.documentElement.clientHeight - 150;\r\n\tif (!iframeRef.value) return;\r\n\tiframeRef.value.style.height = `${clientHeight}px`;\r\n\t// TODO\r\n\t// if (iframe.value.attachEvent) {\r\n\t// \tiframe.value.attachEvent('onload', () => {\r\n\t// \t\thide();\r\n\t// \t});\r\n\t// } else {\r\n\t// \tiframe.value.onload = () => {\r\n\t// \t\thide();\r\n\t// \t};\r\n\t// }\r\n\tiframeRef.value.onload = () => {\r\n\t\thide();\r\n\t};\r\n};\r\n\r\nload();\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.iframe {\r\n\tbox-sizing: border-box;\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\toverflow: hidden;\r\n\tborder: 0;\r\n}\r\n</style>\r\n"],"names":["route","VueRouter","useRoute","iframeRef","Vue","ref","NProgress","configure","showSpinner","src","query","url","replace","watch","hide","done","load","start","time","timeFunc","setInterval","clearInterval","iframeInit","clientHeight","document","documentElement","value","style","height","onload"],"mappings":"wIAWA,MAAAA,EAAAC,UAAAC,WACAC,EAAAC,IAAAC,MACAC,EAAAC,UAAA,CAAAC,aAAA,IACA,MAAAC,EAAAL,kBACAJ,EAAAU,MAAAC,IAAAC,QAAA,KAAA,OAIAR,IAAAS,OAAA,IAAAb,EAAAU,QAAA,YAOA,MAIAI,EAAA,KACAR,EAAAS,QAGAC,EAAA,KAPAV,EAAAW,QAUA,IAAAC,EAAA,EACA,MAAAC,EAAAC,aAAA,KACAF,IACA,GAAAA,QAEAG,cAAAF,MACA,UAKAG,EAAA,KACA,MAAAC,EAAAC,SAAAC,gBAAAF,aAAA,IACApB,EAAAuB,QACAvB,EAAAuB,MAAAC,MAAAC,OAAA,GAAAL,MAWApB,EAAAuB,MAAAG,OAAA"}