import{j as e,l as t}from"./index.9ee08915.js";let a={"../option/crud/index.ts":()=>t((()=>import("./index.51ee7747.js")),[])},r={"../api/auth.ts":()=>t((()=>import("./auth.0d7c2c99.js")),["assets/auth.0d7c2c99.js","assets/index.9ee08915.js","assets/index.90748f1b.css"]),"../api/user.ts":()=>t((()=>import("./index.9ee08915.js").then((function(e){return e.x}))),["assets/index.9ee08915.js","assets/index.90748f1b.css"]),"../api/crud/index.ts":()=>t((()=>import("./index.afb3cad1.js")),["assets/index.afb3cad1.js","assets/index.9ee08915.js","assets/index.90748f1b.css"])};const u=Vue.defineComponent({__name:"crud",setup(t){let{bindVal:u,onEvent:l,page:n,form:o,crud:s}=(t=>{let u=a[`../option/${t.apiPath}.ts`],l=r[`../api/${t.optionPath}.ts`];const n=Vue.ref([]);let o=Vue.ref({}),s=Vue.reactive({}),d=Vue.ref({}),c=Vue.reactive({}),i=Vue.ref(),p=Vue.ref(!1);const f=Vue.ref({current:1,size:20,total:0}),m=Vue.computed((()=>({ref:"crud",option:d.value,data:n.value,tableLoading:p.value}))),v=Vue.computed((()=>({"size-change":B,"current-change":y,"row-save":_,"row-update":g,"row-del":E,"refresh-change":x,"search-reset":P,"search-change":P}))),V=Vue.computed((()=>t.rowKey||"id"));u().then((e=>{d.value=e.default()})),l().then((e=>{c=e,h()}));const h=()=>{e(t.listBefore)&&t.listBefore(),(()=>{var a;p.value=!0;const r=Object.assign({current:f.value.current,size:f.value.size},s);n.value=[],c[(null==(a=t.apiName)?void 0:a.list)||"list"](r).then((a=>{const{data:r}=a;f.value.total=r[t.totalKey||"total"];const u=r[t.dataKey||"record"];n.value=u,e(t.listAfter)&&t.listAfter(r)})).finally((()=>{p.value=!1}))})()},_=(e,a,r)=>{var u;t.addBefore&&t.addBefore(),Reflect.deleteProperty(o.value,"params"),c[(null==(u=t.apiName)?void 0:u.add)||"add"](o.value).then((e=>{h(),t.addAfter?t.addAfter(e):ElementPlus.ElMessage.success("新增成功"),a()})).catch((()=>{r()}))},g=(e,a,r,u)=>{var l;t.updateBefore&&t.updateBefore(),Reflect.deleteProperty(o.value,"params"),c[(null==(l=t.apiName)?void 0:l.update)||"update"](o.value).then((e=>{h(),t.updateAfter?t.updateAfter(e):ElementPlus.ElMessage.success("更新成功"),r()})).catch((()=>{u()}))},E=(e,a)=>{const r=()=>{var r;c[(null==(r=t.apiName)?void 0:r.del)||"del"](e[V.value],e).then((r=>{h(),t.delAfter?t.delAfter(r,e,a):ElementPlus.ElMessage.success("删除成功")}))};t.delBefore?(t.delBefore(),r()):ElementPlus.ElMessageBox.confirm(`此操作将永久删除序号【${a}】的数据, 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{r()}))},P=(e,a)=>{var r;a&&a(),s=(null==(r=t.searchParams)?void 0:r.call(t,e))||e,f.value.current=1,h()},x=()=>{h()},B=e=>{f.value.current=1,f.value.size=e,h()},y=e=>{f.value.current=e,h()};return{bindVal:m,onEvent:v,rowKey:V,crud:i,refreshChange:x,page:f,form:o,params:s}})({apiPath:"crud/index",optionPath:"crud/index",searchParams:e=>(Reflect.has(e,"queryTime")&&(e.startTime=e.queryTime[0],e.endTime=e.queryTime[0],Reflect.deleteProperty(e,"queryTime")),e),listBefore:()=>{},listAfter:e=>{e.record[0].name}});return Vue.onMounted((()=>{s.value})),(e,t)=>{const a=Vue.resolveComponent("avue-crud"),r=Vue.resolveComponent("basic-container");return Vue.openBlock(),Vue.createBlock(r,null,{default:Vue.withCtx((()=>[Vue.createVNode(a,Vue.mergeProps(Vue.unref(u),Vue.toHandlers(Vue.unref(l)),{page:Vue.unref(n),"onUpdate:page":t[0]||(t[0]=e=>Vue.isRef(n)?n.value=e:n=e),modelValue:Vue.unref(o),"onUpdate:modelValue":t[1]||(t[1]=e=>Vue.isRef(o)?o.value=e:o=e)}),null,16,["page","modelValue"])])),_:1})}}});export{u as default};
//# sourceMappingURL=crud.45721f28.js.map
