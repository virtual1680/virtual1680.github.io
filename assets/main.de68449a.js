var e=Object.defineProperty,t=(t,a,i)=>(((t,a,i)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i})(t,"symbol"!=typeof a?a+"":a,i),i);import{_ as a}from"./index.9ee08915.js";class i{constructor(e){t(this,"video"),t(this,"mediaRecorder"),t(this,"chunks"),this.video=e,this.mediaRecorder=null,this.chunks=[]}init(){return new Promise(((e,t)=>{navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((t=>{"srcObject"in this.video&&(this.video.srcObject=t),this.video.addEventListener("loadmetadata",(()=>{this.video.play()})),this.mediaRecorder=new MediaRecorder(t),this.mediaRecorder.addEventListener("dataavailable",(e=>{this.chunks.push(e.data)})),e()})).catch((e=>{t(e)}))}))}startRecord(){var e;"inactive"===(null==(e=this.mediaRecorder)?void 0:e.state)&&this.mediaRecorder.start()}stopRecord(){var e;"recording"===(null==(e=this.mediaRecorder)?void 0:e.state)&&this.mediaRecorder.stop()}async isSupport(){const e=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia;if(await e())return!0}}const d={class:"basic-video__border"},r=["src"],n=Vue.defineComponent({name:"basic-video"});var o=a(Vue.defineComponent({...n,props:{background:{type:String},width:{type:Number,default:500}},emits:["data-change"],setup(e,{emit:t}){const a=e,n=Vue.ref(null),o=Vue.computed((()=>({width:`${a.width}px`}))),s=Vue.computed((()=>({width:a.width/2+"px"}))),l=Vue.computed((()=>({width:a.width/15+"px",height:a.width/15+"px",borderWidth:"5px"}))),u=Vue.ref(null),c=()=>{var e;const a=new Blob(null==(e=u.value)?void 0:e.chunks,{type:"video/mp4"}),i=new FileReader;i.readAsDataURL(a),i.addEventListener("loadend",(()=>{let e=i.result;t("data-change",e)}))};return Vue.onMounted((()=>{u.value=new i(n.value),u.value.init().then((()=>{var e,t;null==(t=null==(e=u.value)?void 0:e.mediaRecorder)||t.addEventListener("stop",c,!1)}))})),(t,a)=>(Vue.openBlock(),Vue.createElementBlock("div",{style:Vue.normalizeStyle(Vue.unref(o)),class:"basic-video"},[Vue.createElementVNode("div",d,[Vue.createElementVNode("span",{style:Vue.normalizeStyle(Vue.unref(l))},null,4),Vue.createElementVNode("span",{style:Vue.normalizeStyle(Vue.unref(l))},null,4),Vue.createElementVNode("span",{style:Vue.normalizeStyle(Vue.unref(l))},null,4),Vue.createElementVNode("span",{style:Vue.normalizeStyle(Vue.unref(l))},null,4)]),Vue.createElementVNode("img",{style:Vue.normalizeStyle(Vue.unref(s)),class:"basic-video__img",src:e.background},null,12,r),Vue.createElementVNode("video",{class:"basic-video__main",ref_key:"videoRef",ref:n,autoplay:"",muted:""},null,512)],4))}}),[["__scopeId","data-v-5567f7de"]]);export{o as default};
//# sourceMappingURL=main.de68449a.js.map
