import{g as p}from"./index.308dce99.js";import{l as P,b as T,d as B}from"./element-plus.99fc94f8.js";import{r as f,a0 as j,e as b,H as I,d as K,a4 as D,k as M,O as U,P as H,X as N,L as S,u as m,D as w,aj as X}from"./vue.e587a6e4.js";let $={"../option/crud/index.ts":()=>p(()=>import("./index.a9ffe0a1.js"),[])},q={"../api/auth.ts":()=>p(()=>import("./auth.f1f28e56.js"),["assets/auth.f1f28e56.js","assets/index.308dce99.js","assets/index.2b38ed39.css","assets/vue.e587a6e4.js","assets/element-plus.99fc94f8.js"]),"../api/user.ts":()=>p(()=>import("./index.308dce99.js").then(function(e){return e.j}),["assets/index.308dce99.js","assets/index.2b38ed39.css","assets/vue.e587a6e4.js","assets/element-plus.99fc94f8.js"]),"../api/crud/index.ts":()=>p(()=>import("./index.965785b6.js"),["assets/index.965785b6.js","assets/index.308dce99.js","assets/index.2b38ed39.css","assets/vue.e587a6e4.js","assets/element-plus.99fc94f8.js"])};const G=e=>{let v=$[`../option/${e.sourcePath}.ts`],_=q[`../api/${e.sourcePath}.ts`];const c=f([]);let r=f({}),h=j({}),g=f({}),s=j({}),E=f(),o=f(!1);const t=f({current:1,size:20,total:0}),A=b(()=>({ref:"crud",option:g.value,data:c.value,tableLoading:o.value})),V=b(()=>({"size-change":L,"current-change":R,"row-save":F,"row-update":y,"row-del":k,"refresh-change":O,"search-reset":C,"search-change":C})),x=b(()=>e.rowKey||"id");v().then(a=>{g.value=a.default()}),_().then(a=>{s=a,d()});const d=()=>{const a=()=>{o.value=!0;const l=Object.assign({current:t.value.current,size:t.value.size},h);c.value=[],s[e.list||"list"](l).then(n=>{o.value=!1;let u;e.res?u=e.res(n.data):u=n.data,t.value.total=u[e.totalKey||"total"];const i=u[e.dataKey||"data"];c.value=i,P(e.listAfter)&&e.listAfter(u)}).finally(()=>{o.value=!1})};P(e.listBefore)&&e.listBefore(),a()},F=(a,l,n)=>{const u=()=>{Reflect.deleteProperty(r.value,"params"),s[e.add||"add"](r.value).then(i=>{d(),e.addAfter?e.addAfter(i):B.success("\u65B0\u589E\u6210\u529F"),l()}).catch(()=>{n()})};e.addBefore&&e.addBefore(),u()},y=(a,l,n,u)=>{const i=()=>{Reflect.deleteProperty(r.value,"params"),s[e.update||"update"](r.value).then(z=>{d(),e.updateAfter?e.updateAfter(z):B.success("\u66F4\u65B0\u6210\u529F"),n()}).catch(()=>{u()})};e.updateBefore&&e.updateBefore(),i()},k=(a,l)=>{const n=()=>{s[e.del||"del"](a[x.value],a).then(u=>{d(),e.delAfter?e.delAfter(u,a,l):B.success("\u5220\u9664\u6210\u529F")})};e.delBefore?(e.delBefore(),n()):T.confirm(`\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u5E8F\u53F7\u3010${l}\u3011\u7684\u6570\u636E, \u662F\u5426\u7EE7\u7EED?`,"\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{n()})},C=(a,l)=>{l&&l(),t.value.current=1,d()},O=()=>{d()},L=a=>{t.value.current=1,t.value.size=a,d()},R=a=>{t.value.current=a,d()};return A.value.option,{bindVal:A,onEvent:V,rowKey:x,crud:E,refreshChange:O,page:t,form:r}},Y=I({__name:"crud",setup(e){let{bindVal:v,onEvent:_,page:c,form:r,crud:h}=G({sourcePath:"crud/index"});return K(()=>{h.value}),(g,s)=>{const E=D("avue-crud"),o=D("basic-container");return M(),U(o,null,{default:H(()=>[N(E,S(m(v),X(m(_)),{page:m(c),"onUpdate:page":s[0]||(s[0]=t=>w(c)?c.value=t:c=t),modelValue:m(r),"onUpdate:modelValue":s[1]||(s[1]=t=>w(r)?r.value=t:r=t)}),null,16,["page","modelValue"])]),_:1})}}});export{Y as default};
//# sourceMappingURL=crud.e95e0acc.js.map
