var e=Object.defineProperty,t=(t,a,i)=>(((t,a,i)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i})(t,"symbol"!=typeof a?a+"":a,i),i);import{_ as a}from"./index.889f4e9c.js";class i{constructor(e){t(this,"video"),t(this,"mediaRecorder"),t(this,"chunks"),this.video=e,this.mediaRecorder=null,this.chunks=[]}init(){return new Promise(((e,t)=>{navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((t=>{"srcObject"in this.video&&(this.video.srcObject=t),this.video.addEventListener("loadmetadata",(()=>{this.video.play()})),this.mediaRecorder=new MediaRecorder(t),this.mediaRecorder.addEventListener("dataavailable",(e=>{this.chunks.push(e.data)})),e()})).catch((e=>{t(e)}))}))}startRecord(){"inactive"===this.mediaRecorder.state&&this.mediaRecorder.start()}stopRecord(){"recording"===this.mediaRecorder.state&&this.mediaRecorder.stop()}async isSupport(){const e=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia;if(await e())return!0}}const d={class:"basic-video__border"},r=["src"],n=Vue.defineComponent({name:"basic-video"});var s=a(Vue.defineComponent({...n,props:{background:{type:String},width:{type:Number,default:500}},emits:["data-change"],setup(e,{emit:t}){const a=e,n=Vue.ref(),s=Vue.computed((()=>({width:`${a.width}px`}))),o=Vue.computed((()=>({width:a.width/2+"px"}))),u=Vue.computed((()=>({width:a.width/15+"px",height:a.width/15+"px",borderWidth:"5px"}))),l=Vue.ref(),c=()=>{const e=new Blob(l.value.chunks,{type:"video/mp4"}),a=new FileReader;a.readAsDataURL(e),a.addEventListener("loadend",(()=>{let e=a.result;t("data-change",e)}))};return(()=>{l.value=new i(n.value);l.value.init().then((()=>{l.value.mediaRecorder.addEventListener("stop",c,!1)}))})(),(t,a)=>(Vue.openBlock(),Vue.createElementBlock("div",{style:Vue.normalizeStyle(Vue.unref(s)),class:"basic-video"},[Vue.createElementVNode("div",d,[Vue.createElementVNode("span",{style:Vue.normalizeStyle(Vue.unref(u))},null,4),Vue.createElementVNode("span",{style:Vue.normalizeStyle(Vue.unref(u))},null,4),Vue.createElementVNode("span",{style:Vue.normalizeStyle(Vue.unref(u))},null,4),Vue.createElementVNode("span",{style:Vue.normalizeStyle(Vue.unref(u))},null,4)]),Vue.createElementVNode("img",{style:Vue.normalizeStyle(Vue.unref(o)),class:"basic-video__img",src:e.background},null,12,r),Vue.createElementVNode("video",{class:"basic-video__main",ref_key:"main",ref:n,autoplay:"",muted:""},null,512)],4))}}),[["__scopeId","data-v-2873dd45"]]);export{s as default};
//# sourceMappingURL=main.d675272d.js.map
